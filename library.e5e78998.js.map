{"mappings":"gfAAAA,EAAA,S,6BAIA,EAAAC,EAAAC,gBAEA,IAAMC,EAAYC,SAASC,cAAc,eAiBzC,SAASC,EAAUC,GACjB,IAAMC,EAAOC,aAAaC,QAAQH,GAClC,OAAIC,EAAaG,KAAKC,MAAMJ,GACrB,E,CAGT,SAASK,EAAaL,GACpB,IAAMM,EAASN,EACZO,KAAI,SAAAC,G,IAIEC,EAHCC,EAAO,IAAIC,KAAKH,EAAGI,cACrBC,EAAa,GAgBjB,OAdc,QAATJ,EAAAD,EAAGM,cAAM,IAATL,OAAA,EAAAA,EAAWM,QAWdF,EAAaL,EAAGM,OAAOP,KAAI,SAAAS,G,OAAOA,EAAJC,I,KAV9BT,EAAGU,UAAUC,SAAQ,SAAAC,GACPC,gBAAgBC,iBAAiBR,OACzCK,SAAQ,SAAAH,G,IAAGO,EAAEP,EAAFO,GAAIN,EAAID,EAAJC,KACbM,IAAOH,GACTP,EAAWW,KAAKP,E,OAItBJ,EAAaA,EAAWY,MAAM,EAAG,IAK5B,iCAGSC,OAHwBlB,EAAGe,GAAG,0GAOXG,OAJnBlB,EAAGmB,YACJ,wJAMDD,OAHqBlB,EAAGoB,MAAM,0EAGHF,OAA3Bb,EAAWgB,KAAK,MAAM,OAAwBH,OAAnBhB,EAAKoB,cAAc,sF,IAO7DD,KAAK,IAEajC,SAASC,cAAc,mBAC/BkC,UAAYzB,C,CA7D3BD,EAAaP,EAAU,YAEvBH,EAAUqC,iBAAiB,SAAS,SAAAC,GAClC,IAAMC,EAASD,EAAIC,OAAOC,QAAQ,UAClC,IAAKD,EAAQ,OAAO,EAEpB,IAAME,EAAYF,EAAOG,QAAQtC,KACjCmC,EACGC,QAAQ,MACRtC,cAAc,cACdyC,UAAUC,OAAO,aACpBL,EAAOI,UAAUE,IAAI,aACrBnC,EAAaP,EAAUsC,G,IAqDvBK,OAAOT,iBAAiB,WAAW,SAAAC,GACjC,IAAMG,EAAYxC,SAASC,cAAc,0BAA0BwC,QAChEtC,KAEc,eAAbkC,EAAIjC,MACNK,EAAaP,EAAUsC,G","sources":["src/library.js"],"sourcesContent":["import './js/blinking-heart.js';\nimport { hidePreloder, showPreloder } from './js/preloder';\nimport './js/modal-movie.js';\n\nhidePreloder();\n\nconst filterRef = document.querySelector('.js-filters');\n\ncreateMarkup(getMovies('watched'));\n\nfilterRef.addEventListener('click', evt => {\n  const target = evt.target.closest('button');\n  if (!target) return false;\n\n  const movieType = target.dataset.type;\n  target\n    .closest('ul')\n    .querySelector('.is-active')\n    .classList.remove('is-active');\n  target.classList.add('is-active');\n  createMarkup(getMovies(movieType));\n});\n\nfunction getMovies(type) {\n  const data = localStorage.getItem(type);\n  if (data) return JSON.parse(data);\n  return [];\n}\n\nfunction createMarkup(data) {\n  const markup = data\n    .map(el => {\n      const date = new Date(el.release_date);\n      let genres_ids = [];\n      // //\n      if (!el.genres?.length) {\n        el.genre_ids.forEach(el => {\n          const arr = filmsApiService.genres_ids_array.genres;\n          arr.forEach(({ id, name }) => {\n            if (id === el) {\n              genres_ids.push(name);\n            }\n          });\n        });\n        genres_ids = genres_ids.slice(0, 2);\n      } else {\n        genres_ids = el.genres.map(({ name }) => name);\n      }\n      //\n      return `<li class=\"gallery__item\" id=\"${el.id}\">\n            <a class=\"film-card\"\">\n                    <img src=\"https://image.tmdb.org/t/p/w500/${\n                      el.poster_path\n                    }\" \n                        class=\"film-poster__img\" loading=\"lazy\" />\n                <div class=\"info\"\">\n                <p class=\"info__title\">${el.title}</p>\n\n                  <p class=\"info__genres\">\n                  ${genres_ids.join(', ')} | ${date.getFullYear()} \n        \n               </p>\n            </div>\n            </a>\n      </li>`;\n    })\n    .join('');\n\n  const movieGallery = document.querySelector('.movie__gallery');\n  movieGallery.innerHTML = markup;\n}\n\nconst handleCloseModal = () => {\n  window.addEventListener('message', evt => {\n    const movieType = document.querySelector('.js-filters .is-active').dataset\n      .type;\n\n    if (evt.data === 'closeModal') {\n      createMarkup(getMovies(movieType));\n    }\n  });\n};\n\nhandleCloseModal();\n"],"names":["parcelRequire","$2T02J","hidePreloder","$cecbdd76f2d3d4bd$var$filterRef","document","querySelector","$cecbdd76f2d3d4bd$var$getMovies","type","data","localStorage","getItem","JSON","parse","$cecbdd76f2d3d4bd$var$createMarkup","markup","map","el1","ref","date","Date","release_date","genres_ids","genres","length","param","name","genre_ids","forEach","el","filmsApiService","genres_ids_array","id","push","slice","concat","poster_path","title","join","getFullYear","innerHTML","addEventListener","evt","target","closest","movieType","dataset","classList","remove","add","window"],"version":3,"file":"library.e5e78998.js.map"}